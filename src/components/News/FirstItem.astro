---
import { Image } from "astro:assets";
import { getCollection, getEntry } from "astro:content";
const { data, body } = Astro.props;
import OpenAMPLogo from "../../assets/images/content/openAMP_LOGOMARKX.png";
import dayjs from "dayjs";

const dateObj = dayjs(data.date);
const dateString = dateObj.format("dddd, MMMM D, YYYY");

const readTime = `${Math.ceil(body.split(" ").length / 183)} min read`;

const projects = await getCollection("projects");

function findUrl(inputPr: any) {
  const trimmedInput = inputPr.trim().toLowerCase();
  const selectedPr = projects.find(
    (project) => project.data.title.trim().toLowerCase() === trimmedInput
  );

  if (selectedPr) {
    return selectedPr.slug;
  }

  return "/";
}
const convertedTitle = findUrl(data.title);
---

<a
  data-projects={projects}
  class="h-full w-full text-inherit no-underline cursor-pointer col-span-full"
  href={data.url}
>
  <div
    class="flex flex-col rounded-lg mx-auto bg-white shadow-[0_2px_15px_-3px_rgba(0,0,0,0.07),0_10px_20px_-2px_rgba(0,0,0,0.04)] dark:bg-neutral-700 md:max-w-[1200px] md:flex-row"
  >
    <div class="flex flex-col justify-start p-6 md:w-[40%] w-full">
      <div class="flex w-full justify-between items-center my-4">
        <i class="text-xl">OpenAMP</i><Image
          class="w-12"
          src={OpenAMPLogo}
          alt="OpenAMP logo"
        />
      </div>
      <h2 class="text-xl text-left">{data.title}</h2>
      <p class="text-slate-500 w-full">{dateString}</p>

      <ul class="flex flex-wrap gap-2 w-full">
        {
          data.tags.map((tag: any) => (
            <li
              onclick={`window.location.href='/news/tags/${tag.slug}/';`}
              class="bg-gray-100 p-2 text-sm text-gray-600 hover:bg-[#DBE0E5] transition ease-in-out delay-150 rounded-md"
            >
              {tag.slug.toUpperCase()}
            </li>
          ))
        }
      </ul>
      <p class="mb-4 text-xl text-left">
        {data.description}
      </p>

      <button
        onclick=`window.location.href='/news/${convertedTitle}/';`
        id="readme"
        class="bg-openampred w-[20%] transition ease-in-out delay-500 hover:bg-red-600 text-white px-4 py-2 rounded-md mt-6"
        >Read</button
      >
    </div>
    <Image
      class="h-96 md:w-[60%] w-full rounded-t-lg object-cover md:h-auto md:!rounded-none md:!rounded-r-lg"
      src={data.image}
      alt={data.title}
    />
  </div>
</a>
